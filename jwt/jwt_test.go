package jwt_test

import (
	"testing"

	"github.com/tessin/td/jwt"
)

func TestJwtDecode(t *testing.T) {
	claims, _ := jwt.Decode("eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik4tbEMwbi05REFMcXdodUhZbkhRNjNHZUNYYyIsImtpZCI6Ik4tbEMwbi05REFMcXdodUhZbkhRNjNHZUNYYyJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuY29yZS53aW5kb3dzLm5ldC8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9jZTQ5MTJlMy01MTE2LTRlODItYTFmOC0xZTkzY2UwZDM2MDcvIiwiaWF0IjoxNTUzMTQ4MDAxLCJuYmYiOjE1NTMxNDgwMDEsImV4cCI6MTU1MzE1MTkwMSwiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhLQUFBQVRXeUphQmg3YTRTemFYY1VySjBqUG1RcjB1a1JMTEcrQnAzcHJxL0JoT0Y0My9jTi9pSTdHWDJ2TDJMSmZmYTJQTGhKcThlZjc2N096YWlsbnJrdzVXby9CU1V4YXlMNlBQa2I0azR0WUZ3PSIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwaWQiOiIwNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDYiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6IkxlaWRlZ3JlbiIsImdpdmVuX25hbWUiOiJKb2huIiwiZ3JvdXBzIjpbImIyYzU4Y2ZhLTA1YWItNGVlMy04ZDM1LWJiOWFhYmMxNmIyNiIsImI5ZDViMjhhLWI1OWYtNDg4Zi05NjQwLWZiYzliYTVlMWIwMCJdLCJpcGFkZHIiOiI4MS4yMzQuMTY1LjI1MyIsIm5hbWUiOiJKb2huIExlaWRlZ3JlbiIsIm9pZCI6ImMwMjlkYTM4LTI3MzQtNDgzMi04MWFmLTM5MTljZmM1ZmUwYSIsInB1aWQiOiIxMDAzMDAwMEFBNDhDMTg3Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoiRlhoNk1oYjhjTU9qT1MtbTkzY2hBX2dmR0lPWEpMWTBNcjhCNm1iRG9EbyIsInRpZCI6ImNlNDkxMmUzLTUxMTYtNGU4Mi1hMWY4LTFlOTNjZTBkMzYwNyIsInVuaXF1ZV9uYW1lIjoiam9obkB0ZXNzaW4ub25taWNyb3NvZnQuY29tIiwidXBuIjoiam9obkB0ZXNzaW4ub25taWNyb3NvZnQuY29tIiwidXRpIjoidEFsdUFnaGZIRWF3NHN4SjhRc0lBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiNjJlOTAzOTQtNjlmNS00MjM3LTkxOTAtMDEyMTc3MTQ1ZTEwIl19.")
	if claims.Aud() != "https://management.core.windows.net/" {
		t.Fatal("expected audience https://management.core.windows.net/")
	}

	if claims.Exp().Unix() != 1553151901 {
		t.Fatal("expected expiration time 1553151901")
	}
}
